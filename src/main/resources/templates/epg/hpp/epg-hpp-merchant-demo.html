<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" type="text/css" href="/css/merchant.css" th:href="@{/css/merchant.css}" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

</head>
<body>

    <div class="formwrapper">
        <header>
            <div class="py-5 text-center">
                <h2>Example Merchant</h2>
                <p class="lead">
                    Make a test payment with the Elavon Payment Gateway.
                </p>
            </div>
        </header>

        <form method="POST" action="/epg/hpp/epg-hpp-open-hpp" class="needs-validation" novalidate="true" id="paymentForm">
            <div class="mb-2">
                <label for="amount">Amount</label>
                <input id="amount" name="amount" class="form-control" type="tel" min="1" placeholder="" required="true" />
                <div class="invalid-feedback">
                    Please enter a valid amount.
                </div>
            </div>

            <div class="mb-2 dropdown">
                <label for="currency-code">Currency</label>
                <select class="form-select d-block w-100" id="currency-code" name="currency-code">
                    <option>EUR</option>
                    <option>GBP</option>
                </select>
            </div>

            <input
                    type="hidden"
                    th:name="${_csrf.parameterName}"
                    th:value="${_csrf.token}" />

            <hr class="mb-4"/>
            <button class="btn btn-primary" type="submit" id="purchasebtn"><span>Purchase</span></button>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
          const paymentForm = document.getElementById('paymentForm');
          const purchaseBtn = document.getElementById('purchasebtn');

          paymentForm.addEventListener('submit', function(event) {
            if (paymentForm.checkValidity() === true) {
              purchaseBtn.innerHTML = '<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>Loading...';
              purchaseBtn.classList.add('disabled');
            }
          });
        });
    </script>
    <script src="/javascript/bootstrap-form-validation.js" th:src="@{/javascript/bootstrap-form-validation.js}"></script>

</body>
</html>
